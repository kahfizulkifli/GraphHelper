const text = `
HloModule FullyUnrolled.223, input_output_alias={ {1}: (4, {}, must-alias), {2}: (5, {}, must-alias) }

%reduce.52.Reducer.57 (p0.54: f32[], p1.55: f32[]) -> f32[] {
  %p0.54 = f32[] parameter(0)
  %p1.55 = f32[] parameter(1)
  ROOT %add.56 = f32[] add(f32[] %p0.54, f32[] %p1.55)
}

%reduce.112.MaxFunc.117 (p0.114: f32[], p1.115: f32[]) -> f32[] {
  %p0.114 = f32[] parameter(0)
  %p1.115 = f32[] parameter(1)
  ROOT %maximum.116 = f32[] maximum(f32[] %p0.114, f32[] %p1.115)
}

%reduce.118.MaxFunc.123 (p0.120: f32[], p1.121: f32[]) -> f32[] {
  %p0.120 = f32[] parameter(0)
  %p1.121 = f32[] parameter(1)
  ROOT %maximum.122 = f32[] maximum(f32[] %p0.120, f32[] %p1.121)
}

%reduce.129.AddFunc.134 (p0.131: f32[], p1.132: f32[]) -> f32[] {
  %p0.131 = f32[] parameter(0)
  %p1.132 = f32[] parameter(1)
  ROOT %add.133 = f32[] add(f32[] %p0.131, f32[] %p1.132)
}

%reduce.139.AddFunc.144 (p0.141: f32[], p1.142: f32[]) -> f32[] {
  %p0.141 = f32[] parameter(0)
  %p1.142 = f32[] parameter(1)
  ROOT %add.143 = f32[] add(f32[] %p0.141, f32[] %p1.142)
}

%scatter.154.AssignFunc.158 (p0.156: f32[], p1.157: f32[]) -> f32[] {
  %p0.156 = f32[] parameter(0)
  ROOT %p1.157 = f32[] parameter(1)
}

%scatter.159.AssignFunc.163 (p0.161: f32[], p1.162: f32[]) -> f32[] {
  %p0.161 = f32[] parameter(0)
  ROOT %p1.162 = f32[] parameter(1)
}

%reduce.171.Reducer.176 (p0.173: f32[], p1.174: f32[]) -> f32[] {
  %p0.173 = f32[] parameter(0)
  %p1.174 = f32[] parameter(1)
  ROOT %add.175 = f32[] add(f32[] %p0.173, f32[] %p1.174)
}

%reduce.202.Reducer.207 (p0.204: f32[], p1.205: f32[]) -> f32[] {
  %p0.204 = f32[] parameter(0)
  %p1.205 = f32[] parameter(1)
  ROOT %add.206 = f32[] add(f32[] %p0.204, f32[] %p1.205)
}

ENTRY %FullyUnrolled.223 (p0.1: f32[4096,1,4], p1.2: s32[1], p2.3: s32[4], p3.4: s32[], p4.25: f32[128,4,4,1024], p5.26: f32[128,4,4,1024], p6.27: f32[4096], p7.28: f32[4096,4096], p8.29: f32[4096,4096], p9.30: f32[4096,4096], p10.31: f32[4096,4096], p11.32: f32[4096], p12.33: f32[4096,11008], p13.34: f32[4096,11008], p14.35: f32[4096,11008], p15.37: f32[4096], p16.38: f32[4096,32000]) -> (f32[32000,1,4], f32[128,4,4,1024], f32[128,4,4,1024]) {
  %p3.4 = s32[] parameter(3)
  %p16.38 = f32[4096,32000]{1,0} parameter(16)
  %custom-call.199 = f32[4096,32000]{1,0} custom-call(f32[4096,32000]{1,0} %p16.38), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %iota.12 = s32[128]{0} iota(), iota_dimension=0
  %broadcast.13 = s32[1,128]{1,0} broadcast(s32[128]{0} %iota.12), dimensions={1}
  %p1.2 = s32[1]{0} parameter(1)
  %broadcast.14 = s32[1,128]{1,0} broadcast(s32[1]{0} %p1.2), dimensions={0}
  %compare.15 = pred[1,128]{1,0} compare(s32[1,128]{1,0} %broadcast.13, s32[1,128]{1,0} %broadcast.14), direction=LT
  %broadcast.19 = pred[4,1,128]{2,1,0} broadcast(pred[1,128]{1,0} %compare.15), dimensions={1,2}
  %broadcast.16 = s32[4,128]{1,0} broadcast(s32[128]{0} %iota.12), dimensions={1}
  %p2.3 = s32[4]{0} parameter(2)
  %broadcast.17 = s32[4,128]{1,0} broadcast(s32[4]{0} %p2.3), dimensions={0}
  %compare.18 = pred[4,128]{1,0} compare(s32[4,128]{1,0} %broadcast.16, s32[4,128]{1,0} %broadcast.17), direction=GE
  %broadcast.20 = pred[4,1,128]{2,1,0} broadcast(pred[4,128]{1,0} %compare.18), dimensions={0,2}
  %and.21 = pred[4,1,128]{2,1,0} and(pred[4,1,128]{2,1,0} %broadcast.19, pred[4,1,128]{2,1,0} %broadcast.20)
  %broadcast.104 = pred[4,4,1,128]{3,2,1,0} broadcast(pred[4,1,128]{2,1,0} %and.21), dimensions={0,2,3}
  %convert.5 = f32[1]{0} convert(s32[1]{0} %p1.2)
  %reshape.6 = f32[1,1]{1,0} reshape(f32[1]{0} %convert.5)
  %constant.7 = f32[512]{0} constant({1, 0.982171834, 0.964661658, 0.947463512, 0.930572033, 0.913981676, 0.897687137, 0.881683111, 0.865964353, 0.850525856, 0.835362554, 0.820469618, 0.805842221, 0.791475534, 0.777365, 0.763506114, 0.749894202, 0.736525, 0.723394156, 0.710497439, 0.697830558, 0.685389578, 0.673170388, 0.661169052, 0.649381638, 0.637804389, 0.626433551, 0.615265429, 0.604296386, 0.593522906, 0.582941532, 0.572548807, 0.562341332, 0.552315831, 0.542469084, 0.532797873, 0.523299158, 0.51396966, 0.504806578, 0.495806813, 0.486967534, 0.478285819, 0.469758868, 0.461383939, 0.453158349, 0.445079386, 0.437144488, 0.429351032, 0.421696514, 0.414178461, 0.406794429, 0.399542063, 0.392418981, 0.385422885, 0.378551543, 0.371802658, 0.365174145, 0.358663768, 0.352269441, 0.345989168, 0.339820832, 0.333762497, 0.327812135, 0.32196784, 0.316227764, 0.310590029, 0.305052787, 0.29961428, 0.294272721, 0.289026409, 0.283873588, 0.278812647, 0.273841977, 0.26895988, 0.264164835, 0.259455264, 0.254829675, 0.250286549, 0.245824397, 0.241441816, 0.237137362, 0.23290965, 0.228757322, 0.224679008, 0.220673397, 0.216739222, 0.212875158, 0.209080011, 0.2053525, 0.201691449, 0.198095679, 0.194564015, 0.191095293, 0.187688425, 0.18434231, 0.181055814, 0.177827939, 0.174657613, 0.171543792, 0.168485492, 0.165481701, 0.16253148, 0.15963386, 0.156787887, 0.153992653, 0.151247263, 0.148550808, 0.145902425, 0.143301263, 0.140746459, 0.138237223, 0.13577272, 0.133352146, 0.130974725, 0.128639698, 0.12634629, 0.124093771, 0.121881425, 0.119708508, 0.117574319, 0.115478203, 0.113419443, 0.111397386, 0.109411381, 0.107460782, 0.105544962, 0.103663296, 0.101815172, 0.1, 0.0982171819, 0.0964661613, 0.0947463512, 0.0930572, 0.0913981721, 0.0897687078, 0.0881683081, 0.0865964293, 0.0850525796, 0.0835362598, 0.0820469633, 0.0805842131, 0.0791475549, 0.0777365044, 0.076350607, 0.0749894157, 0.0736525, 0.0723394156, 0.0710497424, 0.0697830543, 0.0685389563, 0.0673170388, 0.0661169067, 0.0649381652, 0.0637804419, 0.0626433566, 0.0615265369, 0.0604296438, 0.0593522936, 0.0582941547, 0.0572548769, 0.0562341288, 0.0552315824, 0.0542469062, 0.053279791, 0.0523299128, 0.0513969697, 0.0504806563, 0.0495806821, 0.0486967526, 0.0478285812, 0.0469758846, 0.0461384, 0.0453158356, 0.0445079394, 0.0437144488, 0.0429351032, 0.0421696492, 0.0414178446, 0.0406794436, 0.0399542041, 0.0392419, 0.0385422893, 0.037855152, 0.0371802673, 0.0365174115, 0.035866376, 0.0352269448, 0.0345989168, 0.0339820832, 0.0333762467, 0.0327812098, 0.0321967863, 0.0316227786, 0.0310590025, 0.0305052791, 0.0299614277, 0.0294272732, 0.0289026406, 0.0283873584, 0.0278812684, 0.0273841955, 0.0268959869, 0.0264164843, 0.0259455256, 0.0254829675, 0.0250286553, 0.02458244, 0.024144182, 0.0237137359, 0.0232909676, 0.0228757318, 0.0224679, 0.0220673401, 0.0216739215, 0.0212875176, 0.020908, 0.0205352511, 0.0201691464, 0.0198095683, 0.0194564, 0.0191095304, 0.0187688433, 0.0184342302, 0.0181055833, 0.0177827943, 0.0174657609, 0.0171543788, 0.0168485492, 0.0165481716, 0.0162531473, 0.0159633849, 0.0156787895, 0.0153992651, 0.0151247252, 0.0148550803, 0.0145902429, 0.0143301254, 0.0140746459, 0.0138237225, 0.0135772713, 0.0133352149, 0.0130974725, 0.0128639694, 0.0126346294, 0.0124093769, 0.0121881422, 0.0119708506, 0.0117574325, 0.0115478197, 0.0113419443, 0.0111397384, 0.0109411385, 0.0107460786, 0.0105544962, 0.010366329, 0.0101815173, 0.01, 0.00982171949, 0.00964661594, 0.00947463512, 0.00930572, 0.00913981628, 0.00897687115, 0.00881683081, 0.00865964312, 0.00850525778, 0.00835362542, 0.0082046967, 0.00805842225, 0.00791475549, 0.00777365034, 0.0076350607, 0.00749894232, 0.00736524956, 0.00723394146, 0.00710497424, 0.00697830599, 0.00685389573, 0.00673170388, 0.00661169039, 0.00649381662, 0.00637804391, 0.00626433548, 0.00615265407, 0.00604296429, 0.00593522936, 0.00582941528, 0.0057254876, 0.00562341325, 0.00552315824, 0.0054246909, 0.0053279791, 0.00523299119, 0.00513969688, 0.00504806591, 0.00495806849, 0.00486967526, 0.0047828583, 0.00469758874, 0.00461383956, 0.00453158375, 0.00445079384, 0.00437144469, 0.00429351, 0.00421696482, 0.00414178474, 0.00406794436, 0.00399542041, 0.0039241896, 0.00385422911, 0.00378551544, 0.00371802668, 0.00365174143, 0.00358663779, 0.00352269458, 0.00345989154, 0.00339820841, 0.00333762448, 0.00327812112, 0.0032196783, 0.00316227786, 0.00310590025, 0.003050528, 0.00299614272, 0.00294272718, 0.00289026392, 0.00283873593, 0.0027881267, 0.00273841969, 0.00268959883, 0.00264164829, 0.0025945527, 0.0025482967, 0.00250286539, 0.0024582441, 0.00241441838, 0.00237137382, 0.00232909666, 0.00228757318, 0.00224679, 0.00220673415, 0.00216739206, 0.00212875172, 0.0020908, 0.00205352507, 0.00201691454, 0.00198095664, 0.00194564008, 0.00191095285, 0.00187688426, 0.00184342288, 0.00181055814, 0.00177827943, 0.00174657616, 0.00171543786, 0.00168485485, 0.00165481714, 0.00162531494, 0.00159633858, 0.00156787888, 0.00153992651, 0.00151247263, 0.00148550794, 0.00145902426, 0.00143301266, 0.00140746462, 0.00138237223, 0.0013577271, 0.00133352145, 0.00130974723, 0.00128639687, 0.00126346294, 0.00124093785, 0.00121881417, 0.00119708502, 0.00117574329, 0.00115478202, 0.00113419443, 0.00111397391, 0.0010941138, 0.00107460783, 0.0010554496, 0.00103663292, 0.00101815176, 0.001, 0.000982171856, 0.000964661594, 0.000947463559, 0.000930572103, 0.000913981756, 0.000897687103, 0.000881683, 0.000865964335, 0.000850525801, 0.000835362531, 0.000820469577, 0.000805842225, 0.000791475584, 0.000777365, 0.000763506046, 0.000749894185, 0.000736525, 0.000723394158, 0.000710497377, 0.000697830576, 0.000685389619, 0.000673170376, 0.000661169, 0.000649381662, 0.000637804391, 0.000626433583, 0.000615265395, 0.000604296394, 0.000593522913, 0.000582941517, 0.000572548772, 0.000562341302, 0.000552315847, 0.00054246909, 0.000532797887, 0.000523299095, 0.000513969688, 0.00050480658, 0.000495806802, 0.000486967503, 0.000478285801, 0.000469758874, 0.000461383985, 0.00045315834, 0.000445079408, 0.000437144481, 0.000429351, 0.000421696488, 0.000414178445, 0.000406794425, 0.000399542041, 0.000392419, 0.000385422871, 0.000378551515, 0.000371802656, 0.000365174114, 0.000358663761, 0.000352269446, 0.00034598916, 0.000339820836, 0.000333762466, 0.000327812129, 0.000321967847, 0.000316227786, 0.000310590025, 0.000305052788, 0.000299614272, 0.00029427273, 0.000289026386, 0.000283873611, 0.000278812659, 0.000273841957, 0.000268959877, 0.000264164846, 0.000259455293, 0.000254829676, 0.000250286539, 0.000245824398, 0.000241441812, 0.000237137385, 0.000232909661, 0.000228757315, 0.00022467901, 0.000220673421, 0.000216739209, 0.000212875166, 0.000209080012, 0.000205352495, 0.000201691451, 0.000198095673, 0.000194564011, 0.0001910953, 0.000187688434, 0.000184342294, 0.000181055817, 0.00017782794, 0.000174657602, 0.000171543783, 0.00016848548, 0.000165481717, 0.000162531476, 0.000159633855, 0.000156787879, 0.000153992645, 0.000151247252, 0.000148550811, 0.000145902421, 0.000143301266, 0.000140746473, 0.000138237228, 0.000135772716, 0.00013335215, 0.000130974717, 0.000128639687, 0.000126346291, 0.000124093771, 0.000121881414, 0.000119708508, 0.000117574331, 0.000115478193, 0.000113419439, 0.000111397392, 0.000109411376, 0.000107460779, 0.000105544968, 0.000103663289, 0.000101815174})
  %reshape.8 = f32[1,512]{1,0} reshape(f32[512]{0} %constant.7)
  %dot.9 = f32[1,512]{1,0} dot(f32[1,1]{1,0} %reshape.6, f32[1,512]{1,0} %reshape.8), lhs_contracting_dims={1}, rhs_contracting_dims={0}
  %cosine.11 = f32[1,512]{1,0} cosine(f32[1,512]{1,0} %dot.9)
  %broadcast.77 = f32[1,4,4,512]{3,2,1,0} broadcast(f32[1,512]{1,0} %cosine.11), dimensions={0,3}
  %p0.1 = f32[4096,1,4]{2,1,0} parameter(0)
  %custom-call.36 = f32[4096,1,4]{2,1,0} custom-call(f32[4096,1,4]{2,1,0} %p0.1), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %multiply.50 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %custom-call.36, f32[4096,1,4]{2,1,0} %custom-call.36)
  %constant.51 = f32[] constant(0)
  %reduce.52 = f32[1,4]{1,0} reduce(f32[4096,1,4]{2,1,0} %multiply.50, f32[] %constant.51), dimensions={0}, to_apply=%reduce.52.Reducer.57
  %constant.58 = f32[] constant(0.000244140625)
  %broadcast.59 = f32[1,4]{1,0} broadcast(f32[] %constant.58), dimensions={}
  %multiply.60 = f32[1,4]{1,0} multiply(f32[1,4]{1,0} %reduce.52, f32[1,4]{1,0} %broadcast.59)
  %constant.61 = f32[] constant(1e-05)
  %broadcast.62 = f32[1,4]{1,0} broadcast(f32[] %constant.61), dimensions={}
  %add.63 = f32[1,4]{1,0} add(f32[1,4]{1,0} %multiply.60, f32[1,4]{1,0} %broadcast.62)
  %rsqrt.64 = f32[1,4]{1,0} rsqrt(f32[1,4]{1,0} %add.63)
  %broadcast.65 = f32[4096,1,4]{2,1,0} broadcast(f32[1,4]{1,0} %rsqrt.64), dimensions={1,2}
  %multiply.66 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %custom-call.36, f32[4096,1,4]{2,1,0} %broadcast.65)
  %p6.27 = f32[4096]{0} parameter(6)
  %custom-call.41 = f32[4096]{0} custom-call(f32[4096]{0} %p6.27), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %broadcast.67 = f32[4096,1,4]{2,1,0} broadcast(f32[4096]{0} %custom-call.41), dimensions={0}
  %multiply.68 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %multiply.66, f32[4096,1,4]{2,1,0} %broadcast.67)
  %reshape.69 = f32[4096,4]{1,0} reshape(f32[4096,1,4]{2,1,0} %multiply.68)
  %p7.28 = f32[4096,4096]{1,0} parameter(7)
  %custom-call.42 = f32[4096,4096]{1,0} custom-call(f32[4096,4096]{1,0} %p7.28), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.70 = f32[4,4096]{1,0} dot(f32[4096,4]{1,0} %reshape.69, f32[4096,4096]{1,0} %custom-call.42), lhs_contracting_dims={0}, rhs_contracting_dims={0}
  %reshape.73 = f32[1,4,4,1024]{3,2,1,0} reshape(f32[4,4096]{1,0} %dot.70)
  %slice.78 = f32[1,4,4,512]{3,2,1,0} slice(f32[1,4,4,1024]{3,2,1,0} %reshape.73), slice={[0:1], [0:4], [0:4], [0:512]}
  %multiply.80 = f32[1,4,4,512]{3,2,1,0} multiply(f32[1,4,4,512]{3,2,1,0} %broadcast.77, f32[1,4,4,512]{3,2,1,0} %slice.78)
  %sine.10 = f32[1,512]{1,0} sine(f32[1,512]{1,0} %dot.9)
  %broadcast.76 = f32[1,4,4,512]{3,2,1,0} broadcast(f32[1,512]{1,0} %sine.10), dimensions={0,3}
  %slice.79 = f32[1,4,4,512]{3,2,1,0} slice(f32[1,4,4,1024]{3,2,1,0} %reshape.73), slice={[0:1], [0:4], [0:4], [512:1024]}
  %multiply.81 = f32[1,4,4,512]{3,2,1,0} multiply(f32[1,4,4,512]{3,2,1,0} %broadcast.76, f32[1,4,4,512]{3,2,1,0} %slice.79)
  %subtract.82 = f32[1,4,4,512]{3,2,1,0} subtract(f32[1,4,4,512]{3,2,1,0} %multiply.80, f32[1,4,4,512]{3,2,1,0} %multiply.81)
  %multiply.83 = f32[1,4,4,512]{3,2,1,0} multiply(f32[1,4,4,512]{3,2,1,0} %broadcast.77, f32[1,4,4,512]{3,2,1,0} %slice.79)
  %multiply.84 = f32[1,4,4,512]{3,2,1,0} multiply(f32[1,4,4,512]{3,2,1,0} %broadcast.76, f32[1,4,4,512]{3,2,1,0} %slice.78)
  %add.85 = f32[1,4,4,512]{3,2,1,0} add(f32[1,4,4,512]{3,2,1,0} %multiply.83, f32[1,4,4,512]{3,2,1,0} %multiply.84)
  %concatenate.86 = f32[1,4,4,1024]{3,2,1,0} concatenate(f32[1,4,4,512]{3,2,1,0} %subtract.82, f32[1,4,4,512]{3,2,1,0} %add.85), dimensions={3}
  %constant.98 = f32[] constant(32)
  %broadcast.99 = f32[1,4,4,1024]{3,2,1,0} broadcast(f32[] %constant.98), dimensions={}
  %divide.100 = f32[1,4,4,1024]{3,2,1,0} divide(f32[1,4,4,1024]{3,2,1,0} %concatenate.86, f32[1,4,4,1024]{3,2,1,0} %broadcast.99)
  %p4.25 = f32[128,4,4,1024]{3,2,1,0} parameter(4)
  %custom-call.39 = f32[128,4,4,1024]{3,2,1,0} custom-call(f32[128,4,4,1024]{3,2,1,0} %p4.25), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.101 = f32[4,4,1,128]{3,2,1,0} dot(f32[1,4,4,1024]{3,2,1,0} %divide.100, f32[128,4,4,1024]{3,2,1,0} %custom-call.39), lhs_batch_dims={1,2}, lhs_contracting_dims={3}, rhs_batch_dims={1,2}, rhs_contracting_dims={3}
  %constant.102 = f32[] constant(-30000)
  %broadcast.103 = f32[4,4,1,128]{3,2,1,0} broadcast(f32[] %constant.102), dimensions={}
  %select.105 = f32[4,4,1,128]{3,2,1,0} select(pred[4,4,1,128]{3,2,1,0} %broadcast.104, f32[4,4,1,128]{3,2,1,0} %dot.101, f32[4,4,1,128]{3,2,1,0} %broadcast.103)
  %constant.111 = f32[] constant(-inf)
  %reduce.112 = f32[4,4,1]{2,1,0} reduce(f32[4,4,1,128]{3,2,1,0} %select.105, f32[] %constant.111), dimensions={3}, to_apply=%reduce.112.MaxFunc.117
  %broadcast.23 = s32[4,1]{1,0} broadcast(s32[1]{0} %p1.2), dimensions={1}
  %broadcast.22 = s32[4,1]{1,0} broadcast(s32[4]{0} %p2.3), dimensions={0}
  %compare.24 = pred[4,1]{1,0} compare(s32[4,1]{1,0} %broadcast.23, s32[4,1]{1,0} %broadcast.22), direction=GE
  %broadcast.109 = pred[4,4,1,1]{3,2,1,0} broadcast(pred[4,1]{1,0} %compare.24), dimensions={0,2}
  %broadcast.88 = f32[1,4,4,512]{3,2,1,0} broadcast(f32[1,512]{1,0} %cosine.11), dimensions={0,3}
  %p8.29 = f32[4096,4096]{1,0} parameter(8)
  %custom-call.43 = f32[4096,4096]{1,0} custom-call(f32[4096,4096]{1,0} %p8.29), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.71 = f32[4,4096]{1,0} dot(f32[4096,4]{1,0} %reshape.69, f32[4096,4096]{1,0} %custom-call.43), lhs_contracting_dims={0}, rhs_contracting_dims={0}
  %reshape.74 = f32[1,4,4,1024]{3,2,1,0} reshape(f32[4,4096]{1,0} %dot.71)
  %slice.89 = f32[1,4,4,512]{3,2,1,0} slice(f32[1,4,4,1024]{3,2,1,0} %reshape.74), slice={[0:1], [0:4], [0:4], [0:512]}
  %multiply.91 = f32[1,4,4,512]{3,2,1,0} multiply(f32[1,4,4,512]{3,2,1,0} %broadcast.88, f32[1,4,4,512]{3,2,1,0} %slice.89)
  %broadcast.87 = f32[1,4,4,512]{3,2,1,0} broadcast(f32[1,512]{1,0} %sine.10), dimensions={0,3}
  %slice.90 = f32[1,4,4,512]{3,2,1,0} slice(f32[1,4,4,1024]{3,2,1,0} %reshape.74), slice={[0:1], [0:4], [0:4], [512:1024]}
  %multiply.92 = f32[1,4,4,512]{3,2,1,0} multiply(f32[1,4,4,512]{3,2,1,0} %broadcast.87, f32[1,4,4,512]{3,2,1,0} %slice.90)
  %subtract.93 = f32[1,4,4,512]{3,2,1,0} subtract(f32[1,4,4,512]{3,2,1,0} %multiply.91, f32[1,4,4,512]{3,2,1,0} %multiply.92)
  %multiply.94 = f32[1,4,4,512]{3,2,1,0} multiply(f32[1,4,4,512]{3,2,1,0} %broadcast.88, f32[1,4,4,512]{3,2,1,0} %slice.90)
  %multiply.95 = f32[1,4,4,512]{3,2,1,0} multiply(f32[1,4,4,512]{3,2,1,0} %broadcast.87, f32[1,4,4,512]{3,2,1,0} %slice.89)
  %add.96 = f32[1,4,4,512]{3,2,1,0} add(f32[1,4,4,512]{3,2,1,0} %multiply.94, f32[1,4,4,512]{3,2,1,0} %multiply.95)
  %concatenate.97 = f32[1,4,4,1024]{3,2,1,0} concatenate(f32[1,4,4,512]{3,2,1,0} %subtract.93, f32[1,4,4,512]{3,2,1,0} %add.96), dimensions={3}
  %dot.106 = f32[4,4,1,1]{3,2,1,0} dot(f32[1,4,4,1024]{3,2,1,0} %divide.100, f32[1,4,4,1024]{3,2,1,0} %concatenate.97), lhs_batch_dims={1,2}, lhs_contracting_dims={3}, rhs_batch_dims={1,2}, rhs_contracting_dims={3}
  %constant.107 = f32[] constant(-30000)
  %broadcast.108 = f32[4,4,1,1]{3,2,1,0} broadcast(f32[] %constant.107), dimensions={}
  %select.110 = f32[4,4,1,1]{3,2,1,0} select(pred[4,4,1,1]{3,2,1,0} %broadcast.109, f32[4,4,1,1]{3,2,1,0} %dot.106, f32[4,4,1,1]{3,2,1,0} %broadcast.108)
  %reduce.118 = f32[4,4,1]{2,1,0} reduce(f32[4,4,1,1]{3,2,1,0} %select.110, f32[] %constant.111), dimensions={3}, to_apply=%reduce.118.MaxFunc.123
  %maximum.124 = f32[4,4,1]{2,1,0} maximum(f32[4,4,1]{2,1,0} %reduce.112, f32[4,4,1]{2,1,0} %reduce.118)
  %broadcast.125 = f32[4,4,1,128]{3,2,1,0} broadcast(f32[4,4,1]{2,1,0} %maximum.124), dimensions={0,1,2}
  %subtract.126 = f32[4,4,1,128]{3,2,1,0} subtract(f32[4,4,1,128]{3,2,1,0} %select.105, f32[4,4,1,128]{3,2,1,0} %broadcast.125)
  %exponential.127 = f32[4,4,1,128]{3,2,1,0} exponential(f32[4,4,1,128]{3,2,1,0} %subtract.126)
  %convert.135 = f32[4,4,1,128]{3,2,1,0} convert(f32[4,4,1,128]{3,2,1,0} %exponential.127)
  %p5.26 = f32[128,4,4,1024]{3,2,1,0} parameter(5)
  %custom-call.40 = f32[128,4,4,1024]{3,2,1,0} custom-call(f32[128,4,4,1024]{3,2,1,0} %p5.26), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.148 = f32[4,4,1,1024]{3,2,1,0} dot(f32[4,4,1,128]{3,2,1,0} %convert.135, f32[128,4,4,1024]{3,2,1,0} %custom-call.40), lhs_batch_dims={0,1}, lhs_contracting_dims={3}, rhs_batch_dims={1,2}, rhs_contracting_dims={0}
  %broadcast.136 = f32[4,4,1,1]{3,2,1,0} broadcast(f32[4,4,1]{2,1,0} %maximum.124), dimensions={0,1,2}
  %subtract.137 = f32[4,4,1,1]{3,2,1,0} subtract(f32[4,4,1,1]{3,2,1,0} %select.110, f32[4,4,1,1]{3,2,1,0} %broadcast.136)
  %exponential.138 = f32[4,4,1,1]{3,2,1,0} exponential(f32[4,4,1,1]{3,2,1,0} %subtract.137)
  %convert.146 = f32[4,4,1,1]{3,2,1,0} convert(f32[4,4,1,1]{3,2,1,0} %exponential.138)
  %p9.30 = f32[4096,4096]{1,0} parameter(9)
  %custom-call.44 = f32[4096,4096]{1,0} custom-call(f32[4096,4096]{1,0} %p9.30), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.72 = f32[4,4096]{1,0} dot(f32[4096,4]{1,0} %reshape.69, f32[4096,4096]{1,0} %custom-call.44), lhs_contracting_dims={0}, rhs_contracting_dims={0}
  %reshape.75 = f32[1,4,4,1024]{3,2,1,0} reshape(f32[4,4096]{1,0} %dot.72)
  %dot.149 = f32[4,4,1,1024]{3,2,1,0} dot(f32[4,4,1,1]{3,2,1,0} %convert.146, f32[1,4,4,1024]{3,2,1,0} %reshape.75), lhs_batch_dims={0,1}, lhs_contracting_dims={3}, rhs_batch_dims={1,2}, rhs_contracting_dims={0}
  %add.150 = f32[4,4,1,1024]{3,2,1,0} add(f32[4,4,1,1024]{3,2,1,0} %dot.148, f32[4,4,1,1024]{3,2,1,0} %dot.149)
  %constant.128 = f32[] constant(0)
  %reduce.129 = f32[4,4,1]{2,1,0} reduce(f32[4,4,1,128]{3,2,1,0} %exponential.127, f32[] %constant.128), dimensions={3}, to_apply=%reduce.129.AddFunc.134
  %reduce.139 = f32[4,4,1]{2,1,0} reduce(f32[4,4,1,1]{3,2,1,0} %exponential.138, f32[] %constant.128), dimensions={3}, to_apply=%reduce.139.AddFunc.144
  %add.145 = f32[4,4,1]{2,1,0} add(f32[4,4,1]{2,1,0} %reduce.129, f32[4,4,1]{2,1,0} %reduce.139)
  %convert.147 = f32[4,4,1]{2,1,0} convert(f32[4,4,1]{2,1,0} %add.145)
  %broadcast.151 = f32[4,4,1,1024]{3,2,1,0} broadcast(f32[4,4,1]{2,1,0} %convert.147), dimensions={0,1,2}
  %divide.152 = f32[4,4,1,1024]{3,2,1,0} divide(f32[4,4,1,1024]{3,2,1,0} %add.150, f32[4,4,1,1024]{3,2,1,0} %broadcast.151)
  %transpose.153 = f32[1,4,4,1024]{3,2,1,0} transpose(f32[4,4,1,1024]{3,2,1,0} %divide.152), dimensions={2,0,1,3}
  %reshape.164 = f32[4,4096]{1,0} reshape(f32[1,4,4,1024]{3,2,1,0} %transpose.153)
  %p10.31 = f32[4096,4096]{1,0} parameter(10)
  %custom-call.45 = f32[4096,4096]{1,0} custom-call(f32[4096,4096]{1,0} %p10.31), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.165 = f32[4,4096]{1,0} dot(f32[4,4096]{1,0} %reshape.164, f32[4096,4096]{1,0} %custom-call.45), lhs_contracting_dims={1}, rhs_contracting_dims={1}
  %transpose.166 = f32[4096,4]{1,0} transpose(f32[4,4096]{1,0} %dot.165), dimensions={1,0}
  %reshape.167 = f32[4096,1,4]{2,1,0} reshape(f32[4096,4]{1,0} %transpose.166)
  %add.168 = f32[4096,1,4]{2,1,0} add(f32[4096,1,4]{2,1,0} %reshape.167, f32[4096,1,4]{2,1,0} %custom-call.36)
  %multiply.169 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %add.168, f32[4096,1,4]{2,1,0} %add.168)
  %constant.170 = f32[] constant(0)
  %reduce.171 = f32[1,4]{1,0} reduce(f32[4096,1,4]{2,1,0} %multiply.169, f32[] %constant.170), dimensions={0}, to_apply=%reduce.171.Reducer.176
  %constant.177 = f32[] constant(0.000244140625)
  %broadcast.178 = f32[1,4]{1,0} broadcast(f32[] %constant.177), dimensions={}
  %multiply.179 = f32[1,4]{1,0} multiply(f32[1,4]{1,0} %reduce.171, f32[1,4]{1,0} %broadcast.178)
  %constant.180 = f32[] constant(1e-05)
  %broadcast.181 = f32[1,4]{1,0} broadcast(f32[] %constant.180), dimensions={}
  %add.182 = f32[1,4]{1,0} add(f32[1,4]{1,0} %multiply.179, f32[1,4]{1,0} %broadcast.181)
  %rsqrt.183 = f32[1,4]{1,0} rsqrt(f32[1,4]{1,0} %add.182)
  %broadcast.184 = f32[4096,1,4]{2,1,0} broadcast(f32[1,4]{1,0} %rsqrt.183), dimensions={1,2}
  %multiply.185 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %add.168, f32[4096,1,4]{2,1,0} %broadcast.184)
  %p11.32 = f32[4096]{0} parameter(11)
  %custom-call.46 = f32[4096]{0} custom-call(f32[4096]{0} %p11.32), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %broadcast.186 = f32[4096,1,4]{2,1,0} broadcast(f32[4096]{0} %custom-call.46), dimensions={0}
  %multiply.187 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %multiply.185, f32[4096,1,4]{2,1,0} %broadcast.186)
  %reshape.188 = f32[4096,4]{1,0} reshape(f32[4096,1,4]{2,1,0} %multiply.187)
  %p12.33 = f32[4096,11008]{1,0} parameter(12)
  %custom-call.47 = f32[4096,11008]{1,0} custom-call(f32[4096,11008]{1,0} %p12.33), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.189 = f32[4,11008]{1,0} dot(f32[4096,4]{1,0} %reshape.188, f32[4096,11008]{1,0} %custom-call.47), lhs_contracting_dims={0}, rhs_contracting_dims={0}
  %logistic.190 = f32[4,11008]{1,0} logistic(f32[4,11008]{1,0} %dot.189)
  %multiply.191 = f32[4,11008]{1,0} multiply(f32[4,11008]{1,0} %dot.189, f32[4,11008]{1,0} %logistic.190)
  %p13.34 = f32[4096,11008]{1,0} parameter(13)
  %custom-call.48 = f32[4096,11008]{1,0} custom-call(f32[4096,11008]{1,0} %p13.34), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.192 = f32[4,11008]{1,0} dot(f32[4096,4]{1,0} %reshape.188, f32[4096,11008]{1,0} %custom-call.48), lhs_contracting_dims={0}, rhs_contracting_dims={0}
  %multiply.193 = f32[4,11008]{1,0} multiply(f32[4,11008]{1,0} %multiply.191, f32[4,11008]{1,0} %dot.192)
  %p14.35 = f32[4096,11008]{1,0} parameter(14)
  %custom-call.49 = f32[4096,11008]{1,0} custom-call(f32[4096,11008]{1,0} %p14.35), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %dot.194 = f32[4,4096]{1,0} dot(f32[4,11008]{1,0} %multiply.193, f32[4096,11008]{1,0} %custom-call.49), lhs_contracting_dims={1}, rhs_contracting_dims={1}
  %transpose.195 = f32[4096,4]{1,0} transpose(f32[4,4096]{1,0} %dot.194), dimensions={1,0}
  %reshape.196 = f32[4096,1,4]{2,1,0} reshape(f32[4096,4]{1,0} %transpose.195)
  %add.197 = f32[4096,1,4]{2,1,0} add(f32[4096,1,4]{2,1,0} %reshape.196, f32[4096,1,4]{2,1,0} %add.168)
  %multiply.200 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %add.197, f32[4096,1,4]{2,1,0} %add.197)
  %constant.201 = f32[] constant(0)
  %reduce.202 = f32[1,4]{1,0} reduce(f32[4096,1,4]{2,1,0} %multiply.200, f32[] %constant.201), dimensions={0}, to_apply=%reduce.202.Reducer.207
  %constant.208 = f32[] constant(0.000244140625)
  %broadcast.209 = f32[1,4]{1,0} broadcast(f32[] %constant.208), dimensions={}
  %multiply.210 = f32[1,4]{1,0} multiply(f32[1,4]{1,0} %reduce.202, f32[1,4]{1,0} %broadcast.209)
  %constant.211 = f32[] constant(1e-05)
  %broadcast.212 = f32[1,4]{1,0} broadcast(f32[] %constant.211), dimensions={}
  %add.213 = f32[1,4]{1,0} add(f32[1,4]{1,0} %multiply.210, f32[1,4]{1,0} %broadcast.212)
  %rsqrt.214 = f32[1,4]{1,0} rsqrt(f32[1,4]{1,0} %add.213)
  %broadcast.215 = f32[4096,1,4]{2,1,0} broadcast(f32[1,4]{1,0} %rsqrt.214), dimensions={1,2}
  %multiply.216 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %add.197, f32[4096,1,4]{2,1,0} %broadcast.215)
  %p15.37 = f32[4096]{0} parameter(15)
  %custom-call.198 = f32[4096]{0} custom-call(f32[4096]{0} %p15.37), custom_call_target="AwsNeuronTransferWithStaticRing", api_version=API_VERSION_UNSPECIFIED
  %broadcast.217 = f32[4096,1,4]{2,1,0} broadcast(f32[4096]{0} %custom-call.198), dimensions={0}
  %multiply.218 = f32[4096,1,4]{2,1,0} multiply(f32[4096,1,4]{2,1,0} %multiply.216, f32[4096,1,4]{2,1,0} %broadcast.217)
  %reshape.219 = f32[4096,4]{1,0} reshape(f32[4096,1,4]{2,1,0} %multiply.218)
  %dot.220 = f32[32000,4]{1,0} dot(f32[4096,32000]{1,0} %custom-call.199, f32[4096,4]{1,0} %reshape.219), lhs_contracting_dims={0}, rhs_contracting_dims={0}
  %reshape.221 = f32[32000,1,4]{2,1,0} reshape(f32[32000,4]{1,0} %dot.220)
  %scatter.154 = f32[128,4,4,1024]{3,2,1,0} scatter(f32[128,4,4,1024]{3,2,1,0} %custom-call.39, s32[1]{0} %p1.2, f32[1,4,4,1024]{3,2,1,0} %concatenate.97), update_window_dims={1,2,3}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%scatter.154.AssignFunc.158
  %scatter.159 = f32[128,4,4,1024]{3,2,1,0} scatter(f32[128,4,4,1024]{3,2,1,0} %custom-call.40, s32[1]{0} %p1.2, f32[1,4,4,1024]{3,2,1,0} %reshape.75), update_window_dims={1,2,3}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%scatter.159.AssignFunc.163
  ROOT %tuple.222 = (f32[32000,1,4]{2,1,0}, f32[128,4,4,1024]{3,2,1,0}, f32[128,4,4,1024]{3,2,1,0}) tuple(f32[32000,1,4]{2,1,0} %reshape.221, f32[128,4,4,1024]{3,2,1,0} %scatter.154, f32[128,4,4,1024]{3,2,1,0} %scatter.159)
}
`

export default text;